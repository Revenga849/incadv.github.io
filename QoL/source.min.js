var sourcecode = 'function sleep (time) {\n\
  return new Promise((resolve) => setTimeout(resolve, time));\n\
}\n\
\n\
function createElement(type, id, className) {\n\
	var element = document.createElement(type);\n\
	element.setAttribute("id", id);\n\
	element.setAttribute("class", className);\n\
	return element;\n\
}\n\
\n\
function createOptionsButton(id, className) {\n\
	var element = createElement("div", id, className);\n\
	element.style.paddingBottom = "1px";\n\
	element.style.paddingTop = "1px";\n\
	element.style.paddingRight = "10px";\n\
	element.style.paddingLeft = "10px";\n\
	element.style.marginLeft = "5px";\n\
	element.style.display = "inline";\n\
	return element;\n\
}\n\
\n\
function createTotalsStat(id, labelText) {\n\
	var line = createElement("p", "p-" + id, "combat-log-record");\n\
	line.style.display = "block";\n\
		var label = createElement("span", "l-" + id, null);\n\
		label.innerHTML = "<b>"+labelText+"</b>: ";\n\
	line.append(label);\n\
		var value = createElement("span", "l-" + id + "-value", null);\n\
		value.style.display = "inline-block";\n\
		value.innerText = " ";\n\
	line.append(value);\n\
	return line;\n\
}\n\
\n\
function manPrestige(layer) {\n\
	if (getAvailablePrestigePoints()[layer] != undefined) {\n\
		var floor = gameState.floor;\n\
		document.getElementById("top-menu-prestige-button").click();\n\
		sleep(300).then(() => {\n\
			prestige(layer);\n\
			addLog(9, "Shortcut manual Prestige Layer " + (layer+1) + " at floor " + formatValue(floor), true);\n\
			if (!bTabSwitch) document.getElementById("top-menu-battlefield-button").click();\n\
		});\n\
	}\n\
}\n\
\n\
function manAscend(layer) {\n\
	if (getAvailableAscensionPoints()[layer] != undefined) {\n\
		var AP = getAvailableAscensionPoints()[layer];\n\
		if (AP.gt(0)) {\n\
			document.getElementById("top-menu-ascension-button").click();\n\
			sleep(300).then(() => {\n\
				ascend(layer);\n\
				addLog(11, "Shortcut manual Ascension Layer " + (layer+1) + " for " + formatValue(AP) + " AP", true);\n\
				if (!bTabSwitch) document.getElementById("top-menu-battlefield-button").click();\n\
			});\n\
		}\n\
	}\n\
}\n\
\n\
var logs = [];\n\
var _addCombatLog;\n\
var addLog = function(id, text, ignoreChecks = false) {\n\
	var logtext = _addCombatLog(id, text);\n\
	if (typeof gameState.options !==  "undefined" && typeof gameState.options[id] !==  "undefined" && gameState.options[id] ==  0 || logtext == null)\n\
        return;\n\
	\n\
	if (!ignoreChecks) {\n\
		if (id == 9) { // prestige\n\
			var timestamp = logtext.substr(0, logtext.indexOf(" - "));\n\
			var floormatch = logtext.match(/floor ([0-9e\\.]+)/);\n\
			if (floormatch != null && floormatch.length > 1) {\n\
				var floor = floormatch[1];\n\
			} else {\n\
				return;\n\
			}\n\
			var plmatch = logtext.match(/Prestige Layer (\\d+)/);\n\
			if (plmatch != null && plmatch.length > 1) {\n\
				var pl = plmatch[1];\n\
			} else {\n\
				return;\n\
			}\n\
			\n\
			var multmatch = logtext.match(/\\(.+\\)/);\n\
			if (multmatch != null && multmatch.length > 0) {\n\
				var mult = multmatch[0];\n\
			} else {\n\
				return;\n\
			}\n\
			var timematch = logtext.match(/(last .+ ago)/);\n\
			if (timematch != null && timematch.length > 1) {\n\
				var time = timematch[1];\n\
			}\n\
			\n\
			var totals = new Decimal(1);\n\
			if (typeof gameState.prestige !== "undefined") {\n\
				totals = totals.mul(gameState.prestige.reduce((a,b,c)=>a.multiply(new Decimal(b[1]).add(1).multiply(c>0?c:1)), new Decimal(1)));\n\
				if (typeof gameState.ascension !== "undefined") {\n\
						totals = totals.mul(getAscensionMultiplier());\n\
				}\n\
			}\n\
			\n\
			logtext = (timestamp==""?"":(timestamp + " (" + time +  ") - ")) + "Auto prestige <b>L" + pl + "</b> at floor <b>" + floor +  "</b> | " + mult + " | Total multi: <b>" + formatValue(totals) + "</b>";\n\
		}\n\
	}\n\
	pushLog(logtext);\n\
}\n\
\n\
function pushLog(logtext) {\n\
	logs.push(logtext);\n\
	var divlog = document.getElementById("qol-logs");\n\
	if (logs.length > 500) {\n\
		logs.shift();\n\
		if (divlog != undefined) divlog.removeChild(divlog.firstChild);\n\
	}\n\
	\n\
	var logLine = createElement("p", null, "combat-log-record");\n\
	logLine.style.display = "block";\n\
	logLine.innerHTML = logtext;\n\
	if (divlog != undefined) divlog.append(logLine);\n\
	if (bLog) {\n\
		if (divlog != undefined) divlog.scrollTo(0, divlog.scrollHeight);\n\
	}\n\
}\n\
\n\
var formats = ["Default", "Layered Exp", "Logarithm", "Force Exponential"];\n\
var format = 0;\n\
var _renderNumber;\n\
var formatValue = function (value) {\n\
	try {\n\
		if (!(value instanceof Decimal)) {\n\
			var value = new Decimal(value);\n\
		}\n\
		if (value.lt(1000)) {\n\
			if (Number.isInteger(value.mag))\n\
				return (value).toFixed(0);\n\
			else \n\
				return (value).toFixed(2);\n\
		}\n\
		var mantissa = value.mantissa.toFixed(3);\n\
		var power = value.e;\n\
			\n\
		if (power > 10000) {\n\
			switch (formats[format]) {\n\
				case "Default":\n\
					return _renderNumber(value);\n\
					break;\n\
				case "Layered Exp":\n\
					if (value.layer < 2) {\n\
						return "e" + formatValue(new Decimal(value.e));\n\
					} else {\n\
						return "e" + formatValue(value.log10());\n\
					}\n\
					break;\n\
				case "Logarithm":\n\
					return "e".repeat(value.layer+1) + Math.log10(value.mag).toFixed(4);\n\
					break;\n\
			}\n\
		}\n\
		return mantissa + "e" + power;\n\
	} catch (e) {\n\
		console.log(value);\n\
		throw(e);\n\
	}\n\
}\n\
\n\
function _init() {\n\
	var div = document.getElementById("qol-container");\n\
	if (div != null) {\n\
		div.remove();\n\
	}\n\
	var div = document.getElementById("qol-totals");\n\
	if (div != null) {\n\
		div.remove();\n\
	}\n\
	if (_renderNumber == undefined) {\n\
		_renderNumber = renderNumber;\n\
		renderNumber = formatValue;\n\
	}\n\
	if (_addCombatLog == undefined) {\n\
		_addCombatLog = addCombatLog;\n\
		addCombatLog = addLog;\n\
	}\n\
	var style = document.createElement("style");\n\
	document.head.appendChild(style);\n\
	style.sheet.insertRule(".enemy-damage { font-size: 1vw; }");\n\
	style.sheet.insertRule(".enemy-health { font-size: 1vw; }");\n\
	style.sheet.insertRule("#heroes-container { z-index: -1; }");\n\
	style.sheet.insertRule(".hero-damage { font-size: 1vw; }");\n\
	style.sheet.insertRule(".hero-health { font-size: 1vw; }");\n\
	style.sheet.insertRule(".hero-armor { font-size: 1vw; }");\n\
	style.sheet.insertRule(".hero-healing { font-size: 1vw; }");\n\
	style.sheet.insertRule("#enemies-container { z-index: -1; }");\n\
\n\
	document.getElementById("combat-log").setAttribute("style","width: 55vw; font-size: 1.25vw;");\n\
	\n\
	var lineColor = theme==0?"black":"white";\n\
	var bgColor = theme==1?"black":"white";\n\
	var qoldiv = createElement("div", "qol-container", null);\n\
	qoldiv.style.height = "29.5vw";\n\
	qoldiv.style.position = "fixed";\n\
	qoldiv.style.bottom = "0";\n\
	qoldiv.style.right = "0";\n\
	qoldiv.style.textAlign = "right";\n\
	qoldiv.style.zIndex = "1";\n\
	qoldiv.style.backgroundColor = bgColor;\n\
		var divPrestige = createElement("div", "qol-prestige", null);\n\
		divPrestige.style.height = "19.5vw";\n\
		divPrestige.style.overflow = "auto";\n\
		divPrestige.style.textAlign = "right";\n\
	qoldiv.append(divPrestige);\n\
		var divAscension = createElement("div", "qol-ascension", null);\n\
		divAscension.style.height = "19.5vw";\n\
		divAscension.style.overflow = "auto";\n\
		divAscension.style.textAlign = "right";\n\
		divAscension.style.display = "none";\n\
	qoldiv.append(divAscension);\n\
		var divlog = createElement("div", "qol-logs", null);\n\
		divlog.style.height = "23vw";\n\
		divlog.style.width = "100vw";\n\
		divlog.style.overflow = "auto";\n\
		divlog.style.position = "fixed";\n\
		divlog.style.bottom = "0";\n\
		divlog.style.right = "0";\n\
		divlog.style.textAlign = "center";\n\
		divlog.style.display = "none";\n\
		divlog.style.backgroundColor = bgColor;\n\
	qoldiv.append(divlog);\n\
\n\
	var qolTotals = createElement("div", "qol-totals", null);\n\
	qolTotals.style.position = "fixed";\n\
	qolTotals.style.bottom = "29.5vw";\n\
	qolTotals.style.right = "0";\n\
	qolTotals.style.textAlign = "right";\n\
	qolTotals.style.zIndex = "1";\n\
	qolTotals.style.backgroundColor = bgColor;\n\
	\n\
		var ascLevel = createTotalsStat("asclevel", "Level to next Ascension Point");\n\
		ascLevel.style.borderTop = "1px solid " + lineColor;\n\
	qolTotals.append(ascLevel);\n\
	\n\
		var asclevelLayer = createElement("p", "p-asclevel-layer", "combat-log-record");\n\
		asclevelLayer.style.display = "block";\n\
			var asclevelLayerLabel = createElement("span", "l-asclevel-layer-label", null);\n\
			asclevelLayerLabel.innerHTML = "<b>^ Calculate for Layer</b>: ";\n\
		asclevelLayer.append(asclevelLayerLabel);\n\
			var divminus = createElement("div", "p-asc-layer-minus", "button prestige-menu-button");\n\
			divminus.style.display = "inline";\n\
			divminus.style.padding = "0";\n\
			divminus.style.paddingLeft = "3px";\n\
			divminus.style.paddingRight = "3px";\n\
			divminus.style.margin = "0";\n\
			divminus.style.marginLeft = "5px";\n\
			divminus.style.marginRight = "5px";\n\
			divminus.innerText = "-";\n\
			divminus.setAttribute("onclick", "ascLayerChange(-1);");\n\
		asclevelLayer.append(divminus);	\n\
			var asclevelLayerValue = createElement("span", "l-asclevel-layer-value", null);\n\
			asclevelLayerValue.innerHTML = "19";\n\
		asclevelLayer.append(asclevelLayerValue);\n\
		var divplus = createElement("div", "p-asc-layer-plus", "button prestige-menu-button");\n\
			divplus.style.display = "inline";\n\
			divplus.style.padding = "0";\n\
			divplus.style.paddingLeft = "3px";\n\
			divplus.style.paddingRight = "3px";\n\
			divplus.style.margin = "0";\n\
			divplus.style.marginLeft = "5px";\n\
			divplus.style.marginRight = "5px";\n\
			divplus.innerText = "+";\n\
			divplus.setAttribute("onclick", "ascLayerChange(1);");\n\
		asclevelLayer.append(divplus);\n\
	qolTotals.append(asclevelLayer);\n\
	\n\
		var highestlevel = createTotalsStat("highestlevel", "<b>Highest Level</b>: ");\n\
		highestlevel.style.borderTop = "1px solid " + lineColor;\n\
	qolTotals.append(highestlevel);\n\
	\n\
		var ascmulti = createTotalsStat("ascmulti", "Ascension exp multi");\n\
	qolTotals.append(ascmulti);\n\
	\n\
		var prestigemulti = createTotalsStat("prestigemulti", "Prestige exp multi");\n\
	qolTotals.append(prestigemulti);\n\
	\n\
		var totalmulti = createTotalsStat("totalsmulti", "Total exp multi");\n\
	qolTotals.append(totalmulti);\n\
	\n\
	document.getElementById("battlefield-screen").append(qoldiv);\n\
	document.getElementById("battlefield-screen").append(qolTotals);\n\
	\n\
	init = true;\n\
}\n\
\n\
function initLogs() {\n\
	for (let i = 0; i < gameState.combatLog.length; i++) {\n\
		var logtext = gameState.combatLog[i];\n\
		logs.push(logtext);\n\
		var divlog = document.getElementById("qol-logs");\n\
		var p = document.createElement("p");\n\
		p.setAttribute("class", "combat-log-record");\n\
		p.style.display = "block";\n\
		p.innerHTML = logtext;\n\
		divlog.append(p);\n\
	}\n\
}\n\
\n\
var calcUrl = "https://equeline.github.io/";\n\
function openCalcPL() {\n\
	var url = calcUrl;\n\
	var prestigePoints = getAvailablePrestigePoints();\n\
	var cl = prestigePoints.length;\n\
	var clp = 0;\n\
	if (prestigePoints.length > 0) {\n\
		var clp = formatValue(prestigePoints[prestigePoints.length-1]);\n\
	}\n\
	var rppr = 0;\n\
	var rpdr = 0;\n\
	if (gameState.ascension != undefined) {\n\
		for (let i=0; i<gameState.ascension.length; i++) {\n\
			if (gameState.ascension[i] != undefined) {\n\
				if (gameState.ascension[i][7] == 1) rppr++;\n\
				if (gameState.ascension[i][8] == 1) rpdr++;\n\
			}\n\
		}\n\
	}\n\
	url += "?cl="+cl+"&clp="+clp+"&rppr="+rppr+"&rpdr="+rpdr;\n\
	window.open(url);\n\
}\n\
\n\
function openCalcAL() {\n\
	var url = calcUrl;\n\
	var a1cp = 0;\n\
	var a1cu = 0;\n\
	var a2cp = 0;\n\
	var a2cu = 0;\n\
	var iapg = 0;\n\
	var atp = new Decimal(0);\n\
	if (gameState.ascension != undefined && gameState.ascension[0] != undefined) {\n\
		for (let i=0; i<gameState.ascension.length; i++) {\n\
			if (gameState.ascension[i][11] == 1) iapg++;\n\
		}\n\
		a1cp = gameState.ascension[0][0];\n\
		a1cu = gameState.ascension[0][1];\n\
		atp = getAvailableAscensionPoints()[0];\n\
		if (gameState.ascension[1] != undefined) {\n\
			a2cp = gameState.ascension[1][0];\n\
			a2cu = gameState.ascension[1][1];\n\
			atp = getAvailableAscensionPoints()[1];\n\
		}\n\
	}\n\
	atp = formatValue(atp);\n\
	url += "?a1cp="+a1cp+"&a1cu="+a1cu+"&a2cp="+a2cp+"&a2cu="+a2cu+"&atp="+atp+"&iapg="+iapg;\n\
	window.open(url);\n\
}\n\
\n\
var theme = gameState.options[0];\n\
var drawing = false;\n\
function redraw() {\n\
	if (drawing) return;\n\
	drawing = true;\n\
	try {\n\
		var lineColor = theme==0?"black":"white";\n\
		var lineThinColor = "grey";\n\
		var bgColor = theme==1?"black":"white";\n\
		let __init = init;\n\
		var container = document.getElementById("qol-container");\n\
		var PLs = document.getElementById("qol-prestige");\n\
		var ALs = document.getElementById("qol-ascension");\n\
		var prestigePoints = getAvailablePrestigePoints();\n\
		var ascensionPoints = getAvailableAscensionPoints();\n\
		if (__init) {\n\
			container.innerHTML = null;\n\
			\n\
			/* Calculators row */\n\
			var calculatorsContainer = createElement("p", "p-calculators-container", "combat-log-record");\n\
			calculatorsContainer.style.display = "block";\n\
			calculatorsContainer.style.padding = "4px";\n\
			calculatorsContainer.style.borderTop = "2px solid " + lineColor;\n\
			calculatorsContainer.style.borderBottom = "1px solid " + lineColor;\n\
			\n\
				var span = createElement("span", "l-calculators", null);\n\
				span.innerHTML = "<b>Open calculator</b>: ";\n\
			calculatorsContainer.append(span);\n\
			\n\
				var calcPrestigeButton = createOptionsButton("p-calc-prestige-button", "button prestige-menu-button");\n\
				calcPrestigeButton.innerText = "Calc Prestige";\n\
				calcPrestigeButton.setAttribute("onclick", "openCalcPL();");\n\
			calculatorsContainer.append(calcPrestigeButton);\n\
			\n\
				var calcAscensionButton = createOptionsButton("p-calc-ascension-button", "button prestige-menu-button");\n\
				calcAscensionButton.innerText = "Calc Ascension";\n\
				calcAscensionButton.setAttribute("onclick", "openCalcAL();");\n\
			calculatorsContainer.append(calcAscensionButton);\n\
			\n\
			/* Settings row 1 */\n\
			var settingsContainer = createElement("p", "p-settings-containe", "combat-log-record");\n\
			settingsContainer.style.display = "block";\n\
			settingsContainer.style.padding = "4px";\n\
			settingsContainer.style.borderBottom = "1px solid " + lineColor;\n\
			\n\
				var logButton = createOptionsButton("p-log-button", "button prestige-menu-button");\n\
				logButton.innerText = "Logs";\n\
				logButton.setAttribute("onclick", "toggleLog();");\n\
			settingsContainer.append(logButton);\n\
			\n\
				var formatSetting = createOptionsButton("p-settings-format", "button prestige-menu-button");\n\
				formatSetting.innerText = "Format: Default";\n\
				formatSetting.setAttribute("onclick", "toggleFormat();");\n\
			settingsContainer.append(formatSetting);\n\
			\n\
				var showTotalsSetting = createOptionsButton("p-settings-show-totals", "button prestige-menu-button");\n\
				showTotalsSetting.innerText = "Show Totals ON";\n\
				showTotalsSetting.setAttribute("onclick", "toggleShowTotals();");\n\
			settingsContainer.append(showTotalsSetting);\n\
			\n\
			/* Settings row 2 */\n\
			var autoSettingsContainer = createElement("p", "p-auto-settings-container", "combat-log-record");\n\
			autoSettingsContainer.style.display = "block";\n\
			autoSettingsContainer.style.padding = "4px";\n\
			autoSettingsContainer.style.borderBottom = "2px solid " + lineColor;\n\
			\n\
				var prestigeAscencionToggle = createOptionsButton("p-plal-toggle-button", "button prestige-menu-button");\n\
				prestigeAscencionToggle.innerText = "List: PL";\n\
				prestigeAscencionToggle.setAttribute("onclick", "togglePLAL();");\n\
			autoSettingsContainer.append(prestigeAscencionToggle);\n\
			\n\
				var noTabSwitchToggle = createOptionsButton("p-tabswitch-toggle-button", "button prestige-menu-button");\n\
				noTabSwitchToggle.innerText = "Tab switch ON";\n\
				noTabSwitchToggle.setAttribute("onclick", "toggleTabSwitch();");\n\
			autoSettingsContainer.append(noTabSwitchToggle);\n\
			\n\
				var prestigeToggle = createOptionsButton("p-prestige-toggle-button", "button prestige-menu-button");\n\
				prestigeToggle.innerText = "Manual buttons ON";\n\
				prestigeToggle.setAttribute("onclick", "togglePrestige();");\n\
			autoSettingsContainer.append(prestigeToggle);\n\
			\n\
			container.append(calculatorsContainer);\n\
			container.append(settingsContainer);\n\
			container.append(autoSettingsContainer)\n\
			\n\
			var divlog = createElement("div", "qol-logs", null);\n\
			divlog.style.height = "23vw";\n\
			divlog.style.overflow = "auto";\n\
			divlog.style.textAlign = "center";\n\
			divlog.style.display = "none";\n\
			divlog.style.position = "fixed";\n\
			divlog.style.botton = "0";\n\
			divlog.style.right = "0";\n\
			divlog.style.width = "100vw";\n\
			container.append(divlog);\n\
			\n\
			var PLheader = createElement("p", "p-l0", "combat-log-record");\n\
			PLheader.style.display = "block";\n\
			\n\
				var plLabel = createElement("span", "l-0-title", null);\n\
				plLabel.style.display = "inline-block";\n\
				plLabel.style.paddingRight = "5px";\n\
				plLabel.innerHTML = "<b>Layer</b>";\n\
			PLheader.append(plLabel);\n\
			\n\
				var expLabel = createElement("span", "l-0-stats", null);\n\
				expLabel.style.display = "inline-block";\n\
				expLabel.style.paddingRight = "5px";\n\
				expLabel.innerHTML = "<b>Stats</b>";\n\
			PLheader.append(expLabel);\n\
			\n\
				var prestigeLabel = createElement("span", "l-0-button", null);\n\
				prestigeLabel.style.marginLeft = "20px";\n\
				prestigeLabel.style.display = "inline-block";\n\
				prestigeLabel.style.textAlign = "center";\n\
				prestigeLabel.innerHTML = "<b>Prestige</b>";\n\
			PLheader.append(prestigeLabel);\n\
			\n\
			PLs = createElement("div", "qol-prestige", null);\n\
			PLs.style.height = "19.5vw";\n\
			PLs.style.overflow = "auto";\n\
			PLs.style.textAlign = "right";\n\
			if (bPLAL) {\n\
				PLs.style.display = "none";\n\
				PLheader.style.display = "none";\n\
			}\n\
			container.append(PLheader);\n\
			container.append(PLs);\n\
			\n\
			var ALheader = createElement("p", "a-l0", "combat-log-record");\n\
			ALheader.style.display = "block";\n\
			ALheader.style.borderBottom = "1px solid " + lineColor;\n\
			ALheader.style.borderTop = "0";\n\
			\n\
				var alLabel = createElement("span", "al-0-title", null);\n\
				alLabel.style.display = "inline-block";\n\
				alLabel.style.paddingRight = "5px";\n\
				alLabel.innerHTML = "<b>AL</b>";\n\
			ALheader.append(alLabel);\n\
			\n\
				var expLabel = createElement("span", "al-0-stats", null);\n\
				expLabel.style.display = "inline-block";\n\
				expLabel.style.paddingRight = "5px";\n\
				expLabel.innerHTML = "<b>Stats</b>";\n\
			ALheader.append(expLabel);\n\
			\n\
				var apLabel = createElement("span", "al-0-ap", null);\n\
				apLabel.style.display = "inline-block";\n\
				apLabel.style.paddingRight = "5px";\n\
				apLabel.innerHTML = "<b>AP</b>";\n\
			ALheader.append(apLabel);\n\
			\n\
				var ascensionLabel = createElement("span", "al-0-button", null);\n\
				ascensionLabel.style.paddingRight = "10px";\n\
				ascensionLabel.style.display = "inline-block";\n\
				ascensionLabel.style.textAlign = "center";\n\
				ascensionLabel.innerHTML = "<b>Ascend</b>";\n\
			ALheader.append(ascensionLabel);\n\
			container.append(ALheader);\n\
			\n\
			ALs = createElement("div", "qol-ascension", null);\n\
			ALs.style.height = "19.5vw";\n\
			ALs.style.overflow = "auto";\n\
			ALs.style.textAlign = "right";\n\
			if (!bPLAL) {\n\
				ALs.style.display = "none";\n\
				ALheader.style.display = "none";\n\
			}\n\
			container.append(ALs);\n\
		}\n\
		\n\
		var ppl = 0;\n\
		for (let i = 0; i < prestigePoints.length; i++) {\n\
			if (gameState.prestige == undefined || i > gameState.prestige.length) break;\n\
			ppl++;\n\
		}\n\
		\n\
		if (ppl != PLs.childElementCount) {\n\
			var divlog = document.getElementById("qol-logs");\n\
			divlog.style.backgroundColor = bgColor;\n\
			\n\
			PLs.innerHTML = null;\n\
			if (gameState.prestige != undefined) {\n\
				for (let i = 0; i < ppl; i++) {\n\
					var layer = createElement("p", "p-l" + (i+1), "combat-log-record");\n\
					layer.style.display = "block";\n\
					\n\
						var plValue = createElement("span", "l-" + (i+1) + "-title", null);\n\
						plValue.style.display = "inline-block";\n\
						plValue.style.paddingRight = "4px";\n\
						plValue.innerHTML = "PL" + (i+1);\n\
					layer.append(plValue);\n\
					\n\
						var expValue = createElement("span", "l-" + (i+1) + "-stats", null);\n\
						expValue.style.display = "inline-block";\n\
						expValue.style.paddingRight = "4px";\n\
						expValue.innerText = " ";\n\
					layer.append(expValue);\n\
					\n\
						var prestigeButton = createElement("div", "l-" + (i+1) + "-button", "button prestige-menu-button");\n\
						prestigeButton.style.paddingBottom = "1px";\n\
						prestigeButton.style.paddingTop = "1px";\n\
						prestigeButton.style.paddingRight = "2px";\n\
						prestigeButton.style.paddingLeft = "2px";\n\
						prestigeButton.style.margin = "0";\n\
						prestigeButton.style.marginLeft = "5px";\n\
						prestigeButton.style.display = "inline-block";\n\
						prestigeButton.style.textAlign = "center";\n\
						prestigeButton.setAttribute("onclick", "manPrestige(" + i + ");");\n\
					layer.append(prestigeButton);\n\
					PLs.append(layer);\n\
				}\n\
			}\n\
			formatLines();\n\
			if (!bPrestige) {\n\
				bPrestige = true;\n\
				togglePrestige();\n\
			}\n\
			if (!bTabSwitch) {\n\
				bTabSwitch = true;\n\
				toggleTabSwitch();\n\
			}\n\
		}\n\
		\n\
		var apl = 0;\n\
		for (let i = 0; i < ascensionPoints.length; i++) {\n\
			if (gameState.ascension == undefined || i > gameState.ascension.length) break;\n\
			apl++;\n\
		}\n\
		\n\
		if (apl != ALs.childElementCount) {\n\
			if (gameState.ascension != undefined) {\n\
				var divlog = document.getElementById("qol-logs");\n\
				divlog.style.backgroundColor = bgColor;\n\
				\n\
				ALs.innerHTML = null;\n\
				for (let i = 0; i < apl; i++) {\n\
					var layer = createElement("p", "a-l" + (i+1), "combat-log-record");\n\
					layer.style.display = "block";\n\
					layer.style.borderBottom = "1px solid " + lineThinColor;\n\
					layer.style.borderTop = "0";\n\
					\n\
						var alLabel = createElement("span", "al-" + (i+1) + "-title", null);\n\
						alLabel.innerHTML = "<b>" + (i+1) + "</b>";\n\
						alLabel.style.paddingRight = "4px";\n\
					layer.append(alLabel);\n\
					\n\
					\n\
						var expValue = createElement("span", "al-" + (i+1) + "-stats", null);\n\
						expValue.style.display = "inline-block";\n\
						expValue.style.paddingRight = "4px";\n\
						expValue.innerText = " ";\n\
					layer.append(expValue);\n\
					\n\
						var apValue = createElement("span", "al-" + (i+1) + "-ap", null);\n\
						apValue.style.paddingRight = "4px";\n\
						apValue.style.display = "inline-block";\n\
						apValue.innerText = " ";\n\
					layer.append(apValue);\n\
					\n\
						var ascensionButton = createElement("div", "al-" + (i+1) + "-button", "button prestige-menu-button");\n\
						ascensionButton.style.paddingBottom = "1px";\n\
						ascensionButton.style.paddingTop = "1px";\n\
						ascensionButton.style.paddingRight = "2px";\n\
						ascensionButton.style.paddingLeft = "2px";\n\
						ascensionButton.style.margin = "0";\n\
						ascensionButton.style.marginLeft = "5px";\n\
						ascensionButton.style.display = "inline-block";\n\
						ascensionButton.style.textAlign = "center";\n\
						//ascensionButton.style.borderLeft = "1px solid " + lineThinColor;\n\
						ascensionButton.setAttribute("onclick", "manAscend(" + i + ");");\n\
					layer.append(ascensionButton);\n\
					\n\
					ALs.append(layer);\n\
				}\n\
			}\n\
			formatLines();\n\
			if (!bPrestige) {\n\
				bPrestige = true;\n\
				togglePrestige();\n\
			}\n\
			if (!bTabSwitch) {\n\
				bTabSwitch = true;\n\
				toggleTabSwitch();\n\
			}\n\
		}\n\
	} finally {\n\
		drawing = false;\n\
	}\n\
}\n\
\n\
function ascLayerChange(n) {\n\
	var span = document.getElementById("l-asclevel-layer-value");\n\
	var t = Number.parseInt(span.innerText);\n\
	var t2 = t+n;\n\
	if (gameState.prestige != undefined) {\n\
		if (t2<19) \n\
			t2=19;\n\
		if (t2<gameState.prestige.length) \n\
			t2 = gameState.prestige.length - 1;\n\
	} else {\n\
		t2 = 20;\n\
	}\n\
	span.innerText = t2;\n\
}\n\
\n\
function getIAPG(PL) {\n\
	var iapg = new Decimal(1);\n\
	if (gameState.ascension != null) {\n\
		var iapgcount = 0;\n\
		for (let i = 0; i < gameState.ascension.length; i++) {\n\
			if (gameState.ascension[i][11] == 1) iapgcount++;\n\
		}\n\
		for (let i = 0; i < iapgcount; i++) {\n\
			iapg = iapg.mul(Decimal.max(1, PL.div(25+5*i)));\n\
		}\n\
	}\n\
	return iapg;\n\
}\n\
\n\
function estimateAscLevel() {\n\
	ascLayerChange(0);\n\
	var availableAscPoints = getAvailableAscensionPoints();\n\
	if (availableAscPoints != undefined && availableAscPoints.length > 0) {\n\
		var ascPoints = availableAscPoints[0];\n\
	} else {\n\
		var ascPoints = new Decimal(0);\n\
	}\n\
	var ascPointsTarget = ascPoints.add(1);\n\
	\n\
	var layer = new Decimal(document.getElementById("l-asclevel-layer-value").innerText);\n\
	var level = new Decimal(gameState.highestAscensionLevel);\n\
	var curPoints = new Decimal(0);\n\
	if (gameState.ascension != undefined) {\n\
		var ascensionExp = new Decimal(gameState.ascension[0][1]);\n\
		var curPoints = curPoints.add(gameState.ascension[0][0]);\n\
	} else {\n\
		var ascensionExp = new Decimal(0);\n\
		var curPoints = new Decimal(0);\n\
	}\n\
	\n\
	if (ascensionExp.gt(0)) {\n\
		curPoints = curPoints.plus(ascensionExp.pow(2.2).floor());\n\
	}\n\
	var level = ascPointsTarget.pow(1/0.85);\n\
	if (ascPointsTarget.gt(1)) {\n\
		level = level.div(curPoints.add(1).pow(0.2)).mul(100).ceil().div(100);\n\
	}\n\
	var scarcity = gameState.trials[6];\n\
	var ipl = 0;\n\
	if (gameState.ascension.length > 2) {\n\
		for (let i = 2; i < gameState.ascension.length; i++) {\n\
			if (gameState.ascension[i][10] != null && gameState.ascension[i][10] == 1) {\n\
				ipl++;\n\
			}\n\
		}\n\
	}\n\
	var PLgain = layer;\n\
	if (ipl > 0) {\n\
		PLgain = PLgain.pow(Decimal.pow(1.09, ipl));\n\
	}\n\
	PLgain = PLgain.minus(10);\n\
	level = Decimal.layeradd(level.pow(1/1.8).mul(100).div(PLgain).div(getIAPG(layer)).pow(Decimal.pow(1.01, scarcity).recip()),2);\n\
	return level.pow(1.01);\n\
}\n\
\n\
bTabSwitch = true;\n\
function toggleTabSwitch() {\n\
	bTabSwitch = !bTabSwitch;\n\
	var l = document.getElementById("p-tabswitch-toggle-button");\n\
	l.innerText = "Tab switch: " + (bTabSwitch?"ON":"OFF");\n\
}\n\
\n\
var bPrestige = false;\n\
function togglePrestige() {\n\
	bPrestige = !bPrestige;\n\
	Array.from(document.querySelectorAll("[id^=l-][id$=button]")).forEach((a,b)=>{\n\
		if (b==0) return;\n\
		a.setAttribute("class", bPrestige?"button prestige-menu-button":"");\n\
		a.setAttribute("onclick", bPrestige?"manPrestige(" + (b-1) + ");":"");\n\
	});\n\
	Array.from(document.querySelectorAll("[id^=al-][id$=button]")).forEach((a,b)=>{\n\
		if (b==0) return;\n\
		a.setAttribute("class", bPrestige?"button prestige-menu-button":"");\n\
		a.setAttribute("onclick", bPrestige?"manAscend(" + (b-1) + ");":"");\n\
	});\n\
	var l = document.getElementById("p-prestige-toggle-button");\n\
	l.innerText = "Manual buttons " + (bPrestige?"ON":"OFF");\n\
	var l = document.getElementById("p-tabswitch-toggle-button");\n\
	l.style.display = bPrestige?"inline":"none";\n\
}\n\
\n\
var bPLAL = false;\n\
function togglePLAL() {\n\
	if (gameState.ascension == null) return;\n\
	bPLAL = !bPLAL;\n\
	var PLtitle = document.getElementById("p-l0");\n\
	var PLs = document.getElementById("qol-prestige");\n\
	var ALtitle = document.getElementById("a-l0");\n\
	var ALs = document.getElementById("qol-ascension");\n\
	var btn = document.getElementById("p-plal-toggle-button");\n\
	if (bPLAL) {\n\
		PLtitle.style.display = "none";\n\
		PLs.style.display = "none";\n\
		ALtitle.style.display = "block";\n\
		ALs.style.display = "block";\n\
		btn.innerText = "List: AL";\n\
	} else {\n\
		PLtitle.style.display = "block";\n\
		PLs.style.display = "block";\n\
		ALs.style.display = "none";\n\
		ALtitle.style.display = "none";\n\
		btn.innerText = "List: PL";\n\
	}\n\
}\n\
\n\
var bLog = false;\n\
function toggleLog() {\n\
	bLog = !bLog;\n\
	var PLtitle = document.getElementById("p-l0");\n\
	var PLs = document.getElementById("qol-prestige");\n\
	var ALtitle = document.getElementById("a-l0");\n\
	var ALs = document.getElementById("qol-ascension");\n\
	var divlog = document.getElementById("qol-logs");\n\
	var divbattle = document.getElementById("combat-log");\n\
	PLs.style.display = (bLog||bPLAL)?"none":"block";\n\
	PLtitle.style.display = (bLog||bPLAL)?"none":"block";\n\
	ALs.style.display = (bLog||!bPLAL)?"none":"block";\n\
	ALtitle.style.display = (bLog||!bPLAL)?"none":"block";\n\
	divlog.style.display = bLog?"block":"none";\n\
	divbattle.style.visibility = bLog?"hidden":"";\n\
	document.getElementById("p-auto-settings-container").style.display = bLog?"none":"block";\n\
	if (bLog) {\n\
		divlog.scrollTo(0, divlog.scrollHeight);\n\
	}\n\
}\n\
\n\
function toggleFormat() {\n\
	format = (format+1)%formats.length;\n\
	var l = document.getElementById("p-settings-format");\n\
	l.innerText = "Format: " + formats[format];\n\
}\n\
\n\
var showTotals = true;\n\
function toggleShowTotals() {\n\
	showTotals = !showTotals;\n\
	var l = document.getElementById("p-settings-show-totals");\n\
	l.innerText = "Show totals: " + (showTotals?"ON":"OFF");\n\
	var t = document.getElementById("qol-totals");\n\
	t.style.display = showTotals?"block":"none";\n\
}\n\
\n\
function formatLines() {\n\
	document.querySelectorAll("[id^=l-][id$=title]").forEach((a)=>{ a.style.width="";});\n\
	var statsLength = Math.max.apply(Math, Array.from(document.querySelectorAll("[id^=l-][id$=title]")).map((a)=>a.clientWidth)) + 1;\n\
	document.querySelectorAll("[id^=l-][id$=title]").forEach((a)=>{ a.style.width=statsLength;});\n\
	\n\
	document.querySelectorAll("[id^=l-][id$=stats]").forEach((a)=>{ a.style.width="";});\n\
	var statsLength = Math.max.apply(Math, Array.from(document.querySelectorAll("[id^=l-][id$=stats]")).map((a)=>a.clientWidth)) + 1;\n\
	document.querySelectorAll("[id^=l-][id$=stats]").forEach((a)=>{ a.style.width=statsLength;});\n\
	\n\
	document.querySelectorAll("[id^=l-][id$=button]").forEach((a)=>{ a.style.width="";});\n\
	var statsLength = Math.max.apply(Math, Array.from(document.querySelectorAll("[id^=l-][id$=button]")).map((a)=>a.clientWidth)) + 1;\n\
	document.querySelectorAll("[id^=l-][id$=button]").forEach((a)=>{ a.style.width=statsLength;});\n\
	\n\
	\n\
	document.querySelectorAll("[id^=al-][id$=title]").forEach((a)=>{ a.style.width="";});\n\
	var statsLength = Math.max.apply(Math, Array.from(document.querySelectorAll("[id^=al-][id$=title]")).map((a)=>a.clientWidth)) + 1;\n\
	document.querySelectorAll("[id^=al-][id$=title]").forEach((a)=>{ a.style.width=statsLength;});\n\
	\n\
	document.querySelectorAll("[id^=al-][id$=stats]").forEach((a)=>{ a.style.width="";});\n\
	var statsLength = Math.max.apply(Math, Array.from(document.querySelectorAll("[id^=al-][id$=stats]")).map((a)=>a.clientWidth)) + 1;\n\
	document.querySelectorAll("[id^=al-][id$=stats]").forEach((a)=>{ a.style.width=statsLength;});\n\
	\n\
	document.querySelectorAll("[id^=al-][id$=ap]").forEach((a)=>{ a.style.width="";});\n\
	var statsLength = Math.max.apply(Math, Array.from(document.querySelectorAll("[id^=al-][id$=ap]")).map((a)=>a.clientWidth)) + 1;\n\
	document.querySelectorAll("[id^=al-][id$=ap]").forEach((a)=>{ a.style.width=statsLength;});\n\
	\n\
	document.querySelectorAll("[id^=al-][id$=button]").forEach((a)=>{ a.style.width="";});\n\
	var statsLength = Math.max.apply(Math, Array.from(document.querySelectorAll("[id^=al-][id$=button]")).map((a)=>a.clientWidth)) + 1;\n\
	document.querySelectorAll("[id^=al-][id$=button]").forEach((a)=>{ a.style.width=statsLength;});\n\
	\n\
	var screen = document.getElementById("battlefield-screen");\n\
	var combatlog = document.getElementById("combat-log");\n\
	var layerdiv = document.getElementById("qol-container");\n\
	if (bLog) {\n\
		combatlog.style.width = "48vw";\n\
	} else {\n\
		combatlog.style.width = screen.clientWidth-layerdiv.clientWidth-5;\n\
	}\n\
}\n\
\n\
String.prototype.toInterval = function () {\n\
    var sec_num = parseInt(this, 10);\n\
    var hours   = Math.floor(sec_num / 3600);\n\
    var minutes = Math.floor((sec_num - (hours * 3600)) / 60);\n\
    var seconds = sec_num - (hours * 3600) - (minutes * 60);\n\
\n\
    if (hours   < 10) {hours   = "0"+hours;}\n\
    if (minutes < 10) {minutes = "0"+minutes;}\n\
    if (seconds < 10) {seconds = "0"+seconds;}\n\
    return hours+":"+minutes+":"+seconds;\n\
}\n\
\n\
var totals10m = [];\n\
var totalsTime = Date.now();\n\
clearInterval(sTotalsInterval);\n\
var sTotalsInterval = setInterval(function() {\n\
	var totals = new Decimal(1);\n\
	if (typeof gameState.prestige !== "undefined") {\n\
		totals = totals.mul(gameState.prestige.reduce((a,b,c)=>a.multiply(new Decimal(b[1]).add(1).multiply(c>0?c:1)), new Decimal(1)));\n\
		if (typeof gameState.ascension !== "undefined") {\n\
			totals = totals.mul(getAscensionMultiplier());\n\
		}\n\
	}\n\
	\n\
	var time = Number.parseInt((Date.now() - totalsTime)/4000);\n\
	if (totals10m.length == 0) {\n\
		var val = [];\n\
		val.time = time;\n\
		val.value = totals;\n\
		totals10m.push(val);\n\
	}\n\
	if (totals10m[totals10m.length-1].time != time) {\n\
		var val = [];\n\
		val.time = time;\n\
		val.value = totals;\n\
		totals10m.push(val);\n\
		if (time>149) {\n\
			totals10m.shift();\n\
		}\n\
	}\n\
	var maxlayer = totals10m.reduce((a,b)=>(a>b.value.layer?a:b.value.layer),totals10m[0].value.layer);\n\
	var minlayer = totals10m.reduce((a,b)=>(a<b.value.layer?a:b.value.layer),totals10m[0].value.layer);\n\
	if (maxlayer != minlayer) {\n\
		totals10m = [];\n\
		totalsTime = Date.now();\n\
		return;\n\
	}\n\
\n\
	if (maxlayer < 1) {\n\
		var average = totals10m.reduce((a,b)=>a.add(b.value), new Decimal(0)).div(totals10m.length);\n\
	} else {\n\
		var average = totals10m.reduce((a,b)=>a.multiply(new Decimal(1).add(b.value)), new Decimal(1)).pow(1/totals10m.length);\n\
	}\n\
	\n\
	if (totals.layer > average.layer) {\n\
		var totalsmag = new Decimal(totals.mag);\n\
		var avgmag = Decimal.layeradd(average.mag, totals.layer - average.layer);\n\
	} else if (totals.layer < average.layer) {\n\
		var avgmag = new Decimal(average.mag);\n\
		var totalsmag = Decimal.layeradd(totals.mag, average.layer - totals.layer);\n\
	} else {\n\
		var avgmag = new Decimal(average.mag);\n\
		var totalsmag = new Decimal(totals.mag);\n\
	}\n\
	\n\
	if (totalsmag.add(0.01).gte(avgmag)) {\n\
		var growth = new Decimal(totalsmag.div(avgmag));\n\
		document.getElementById("l-totalsmulti-value").innerText = "(" + (totals.gte(1e10)?"e ":"") + "+" + formatValue(growth*100-100) + "%) " + formatValue(totals) + "x";\n\
	} else {\n\
		var growth = new Decimal(avgmag.div(totalsmag));\n\
		document.getElementById("l-totalsmulti-value").innerText = "(" + (totals.gte(1e10)?"e ":"") + "-" + formatValue(growth*100-100) + "%) " + formatValue(totals) + "x";\n\
	}\n\
}, 3800);\n\
\n\
function setButtonText(i, text) {\n\
	l = document.getElementById("l-" + (i+1) + "-button")\n\
	if (l != null)\n\
		l.innerText = "Prestige for " + text + "x";\n\
}\n\
\n\
function setAButtonText(i, text) {\n\
	l = document.getElementById("al-" + (i+1) + "-button")\n\
	if (l != null)\n\
		l.innerText = "for " + text + "x";\n\
}\n\
\n\
function setStatsText(i, text) {\n\
	var l = document.getElementById("l-" + (i+1) + "-stats");\n\
	if (l != null)\n\
		l.innerText = text + "x";\n\
}\n\
\n\
function setAStatsText(i, text, ap) {\n\
	var l = document.getElementById("al-" + (i+1) + "-stats");\n\
	if (l != null)\n\
		l.innerText = text;\n\
	var l = document.getElementById("al-" + (i+1) + "-ap");\n\
	if (l != null)\n\
		l.innerText = ap;\n\
}\n\
\n\
function setTotalsText(text) {\n\
	var prestigeTotals = new Decimal(1);\n\
	var ascTotals = new Decimal(1);\n\
	\n\
	if (typeof gameState.prestige !== "undefined") {\n\
		document.getElementById("p-highestlevel").style.display = "block";\n\
		document.getElementById("p-totalsmulti").style.display = "block";\n\
		prestigeTotals = gameState.prestige.reduce((a,b,c)=>a.multiply(new Decimal(b[1]).add(1).multiply(c>0?c:1)), new Decimal(1));\n\
		if (typeof gameState.ascension !== "undefined" && gameState.ascension[0] !== "undefined") {\n\
			var ascensionPoints = getAvailableAscensionPoints()[0];\n\
			document.getElementById("p-ascmulti").style.display = "block";\n\
			document.getElementById("p-prestigemulti").style.display = "block";\n\
			ascTotals = getAscensionMultiplier();\n\
			document.getElementById("l-ascmulti-value").innerText = formatValue(ascTotals) + "x";\n\
			document.getElementById("l-prestigemulti-value").innerText = formatValue(prestigeTotals) + "x";\n\
		} else {\n\
			document.getElementById("p-ascmulti").style.display = "none";\n\
			document.getElementById("p-prestigemulti").style.display = "none";\n\
		}\n\
		document.getElementById("l-highestlevel-value").innerText = formatValue(new Decimal(gameState.highestAscensionLevel));\n\
		\n\
		var prestiges = getAvailablePrestigePoints();\n\
		if (prestiges.length > 13) {\n\
			document.getElementById("p-asclevel").style.display = "block";\n\
			document.getElementById("p-asclevel-layer").style.display = "block";\n\
			document.getElementById("l-asclevel-value").innerText = formatValue(estimateAscLevel());\n\
		} else {\n\
			document.getElementById("p-asclevel").style.display = "none";\n\
			document.getElementById("p-asclevel-layer").style.display = "none";\n\
		}\n\
	} else {\n\
		document.getElementById("p-asclevel").style.display = "none";\n\
		document.getElementById("p-asclevel-layer").style.display = "none";\n\
		document.getElementById("p-highestlevel").style.display = "none";\n\
		document.getElementById("p-prestigemulti").style.display = "none";\n\
		document.getElementById("p-ascmulti").style.display = "none";\n\
		document.getElementById("p-totalsmulti").style.display = "none";\n\
	}\n\
}\n\
\n\
function getALMulti(layer, stat) {\n\
	return new Decimal(stat).plus(1).pow((gameState.trials[1]==7?1:2)*(layer+2)).round();\n\
}\n\
\n\
function getMult(prestigePoints, i) {\n\
	var mult = new Decimal(1);\n\
	if (gameState.prestige != undefined && gameState.prestige[i] != undefined) {\n\
		mult = new Decimal(1);\n\
		var pstats = new Decimal(gameState.prestige[i][1]);\n\
		var upgradePoints = getPrestigePointsFromStatUpgrades(pstats);\n\
		upgradePoints = upgradePoints.plus(gameState.prestige[i][0]).plus(prestigePoints[i]\n\
				.divideBy(5)\n\
				.floor());\n\
		if (getStatUpgradesFromPrestigePoints(upgradePoints).gte(getStatUpgradesFromPrestigePoints(pstats.add(1)))) {\n\
			mult = getStatUpgradesFromPrestigePoints(upgradePoints)\n\
				.plus(1)\n\
				.divideBy(pstats.plus(1));\n\
		}\n\
	} else {\n\
		mult = new Decimal(i==0?1:i);\n\
		var upgradePoints = new Decimal(prestigePoints[i])\n\
				.divideBy(5)\n\
				.floor();\n\
		if (upgradePoints.gt(0)) {\n\
			mult = mult.multiply(getStatUpgradesFromPrestigePoints(upgradePoints).plus(1));\n\
		}\n\
	}\n\
	return mult;\n\
}\n\
\n\
function getStatUpgradesFromAscensionPointsExact(ap) { \n\
    var stat = getStatUpgradesFromAscensionPoints(ap);\n\
    if (getAscensionPointsFromStatUpgrades(stat.plus(1)).lte(ap))\n\
		stat = stat.plus(1);\n\
	return stat;\n\
}\n\
\n\
function getAMult(ascensionPoints, i) {\n\
	var mult = new Decimal(1);\n\
	if (gameState.ascension != undefined && gameState.ascension[i] != undefined) {\n\
		var astats = new Decimal(gameState.ascension[i][1]);\n\
		var upgradePoints = getAscensionPointsFromStatUpgrades(astats);\n\
		upgradePoints = upgradePoints.plus(gameState.ascension[i][0]).plus(ascensionPoints[i]);\n\
		if (getStatUpgradesFromAscensionPointsExact(upgradePoints).gte(getStatUpgradesFromAscensionPointsExact(astats.add(1)))) {\n\
			mult = getALMulti(i, getStatUpgradesFromAscensionPointsExact(upgradePoints)).div(getALMulti(i, astats));\n\
		}\n\
	} else {\n\
		var upgradePoints = new Decimal(ascensionPoints[i]);\n\
		if (upgradePoints.gt(0)) {\n\
			mult = getALMulti(i, getStatUpgradesFromAscensionPointsExact(upgradePoints));\n\
		}\n\
	}\n\
	return mult;\n\
}\n\
\n\
function getCur(i) {\n\
	var cur = new Decimal(1);\n\
	if (gameState.prestige != undefined && gameState.prestige[i] != undefined) {\n\
		cur = new Decimal(gameState.prestige[i][1]).plus(1).multiply(i>0?i:1);\n\
	}\n\
	return cur;\n\
}\n\
\n\
function getACur(i) {\n\
	var cur = new Decimal(1);\n\
	if (gameState.ascension != undefined && gameState.ascension[i] != undefined) {\n\
		cur = getALMulti(i, gameState.ascension[i][1]);\n\
	}\n\
	return cur;\n\
}\n\
\n\
var init = true;\n\
if (sInterval != undefined) {\n\
	clearInterval(sInterval);\n\
}\n\
var sInterval = setInterval(function() {\n\
	if (init) {\n\
		_init();\n\
		redraw();\n\
		initLogs();\n\
		toggleFormat();\n\
	} else {\n\
		if (theme != gameState.options[0]) {\n\
			theme = gameState.options[0];\n\
			_init();\n\
			redraw();\n\
			initLogs();\n\
		} else {\n\
			redraw();\n\
		}\n\
	}\n\
	init = false;\n\
	if (!bPLAL && gameState.prestige != undefined) {\n\
		prestigePoints = getAvailablePrestigePoints();\n\
		\n\
		var curvals = [];\n\
		var multvals = [];\n\
		for (var i = 0; i < prestigePoints.length; i++) {\n\
			curvals[i] = getCur(i);\n\
			multvals[i] = getMult(prestigePoints, i);\n\
			var str = formatValue(multvals[i]);\n\
			var btn = document.getElementById("l-"+(i+1)+"-button");\n\
			var autobuy = 20;\n\
			if (i < prestigePoints.length-1) {\n\
				if (gameState.options != undefined && gameState.options[21] != undefined && gameState.options[21][i+1] != undefined) {\n\
					autobuy = (gameState.options[21][i+1][0]==-1?gameState.options[2]:gameState.options[21][i+1][0]);\n\
				}\n\
			}\n\
			if (btn != undefined) {\n\
				if (getMultiBuyTarget(curvals[i], autobuy).div(curvals[i]).lte(multvals[i])) {\n\
					btn.style.fontWeight = "bold";\n\
				} else {\n\
					btn.style.fontWeight = null;\n\
				}\n\
			}\n\
			setStatsText(i, formatValue(curvals[i]));\n\
			setButtonText(i, str);\n\
		}\n\
	}\n\
	\n\
	if (bPLAL && gameState.ascension != undefined) {\n\
		ascensionPoints = getAvailableAscensionPoints();\n\
		\n\
		var curvals = [];\n\
		var multvals = [];\n\
		for (var i = 0; i < ascensionPoints.length; i++) {\n\
			curvals[i] = getACur(i);\n\
			multvals[i] = getAMult(ascensionPoints, i);\n\
			var str = "(+" + formatValue(ascensionPoints[i]) + ") " + formatValue(multvals[i]);\n\
			//var btn = document.getElementById("al-"+(i+1)+"-button");\n\
			var ap = new Decimal(0);\n\
			if (gameState.ascension != null && gameState.ascension[i] != null) {\n\
				var alStats = new Decimal(gameState.ascension[i][1]);\n\
				ap = ap.plus(gameState.ascension[i][0]).plus(getAscensionPointsFromStatUpgrades(alStats));\n\
			}\n\
			var statsText = formatValue(alStats.plus(1)) + "^" + ((gameState.trials[1]==7?1:2)*(i+2)) + "=" + formatValue(curvals[i]);\n\
			setAStatsText(i, statsText, formatValue(ap));\n\
			setAButtonText(i, str);\n\
		}\n\
	}\n\
	setTotalsText();\n\
	formatLines();\n\
}, 250);';